i:0:0
s:-1_9999,
w:9999*i="#"
t:&//+/(b;e):{w|x&1+(|s@|:)'[x]&(|s@|:)[x]&s'[x]&s x}/'9999*~i=/:"SE"
n:(2 0;1 1;0 2;-1 1;-2 0;-1 -1;0 -2;1 -1)
+//{t>101+(b .x)+9999^e./:x+/:n}'+!#'1+:\i
