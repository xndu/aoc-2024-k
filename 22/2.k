i:`I$0:0

px:{16777216!2/~=/'2\1 x\y}
/ n:px[2048*]px[-32!]px[64*]@!16777216
f:<`"22/data"
n:`I$0:f
/ f 0:$n
>f

|/+/{.'0^(?,/!'x)#/:x}@({(40/'4':-':x)!3_x}10!2000(n@)\)'i
