i:0:0
t:?,/i
ne:{x{~1<+/x*x-:y}/:\:x}
g:{x(|/&)\:x}/
d:,/-:\=2
+/{(#x)*#?g ne@?,/x{(|/x~/:\:2_')_d,'d+\:y}/:x}',/{a@&'?g ne@a:+&x}'i=/:t

