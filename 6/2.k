/ slow
i:0:0
w:+&"#"=i
b:{&/(x<y)&~x<0}[;#'1+:\i]
xt:{[i;w;x]:[0N~x;x;:[b@+/x;:[^w?+/x;|+\|x;{{y,-x}.y}\x];0N]]}[i]
p:xt[w]\(*'&"^"=i;-1 0)
+/{[w;l]~0N~9999xt[w]/l}[;(*'&"^"=i;-1 0)]'w,/:,'?+/'p^0N
